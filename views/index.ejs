<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Items</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <h1>Food Items</h1>
    <div id="food-items">
        <% foodItems.forEach(item => { %>
            <div class="food-item">
                <img src="<%= item.image %>" alt="<%= item.name %>" loading="lazy">
                <h2><%= item.name %></h2>
                <p><%= item.description %></p>
                <p>Price: $<%= item.price %></p>
            </div>
        <% }) %>
    </div>
    <button id="load-more" data-current-page="<%= currentPage %>" data-total-pages="<%= totalPages %>">
        Load More
    </button>

    <script>
        const loadMoreButton = document.getElementById('load-more');
        const foodItemsContainer = document.getElementById('food-items');

        loadMoreButton.addEventListener('click', async () => {
            const currentPage = parseInt(loadMoreButton.getAttribute('data-current-page'));
            const totalPages = parseInt(loadMoreButton.getAttribute('data-total-pages'));

            if (currentPage >= totalPages) return; // No more pages to load

            try {
                const response = await fetch(`/api/foodItems?page=${currentPage + 1}&limit=10`);
                const data = await response.json();
                
                // Append new items to the container
                data.foodItems.forEach(item => {
                    const foodItemDiv = document.createElement('div');
                    foodItemDiv.classList.add('food-item');
                    foodItemDiv.innerHTML = `
                        <img src="${item.image}" alt="${item.name}" loading="lazy">
                        <h2>${item.name}</h2>
                        <p>${item.description}</p>
                        <p>Price: $${item.price}</p>
                    `;
                    foodItemsContainer.appendChild(foodItemDiv);
                });

                // Update current page
                loadMoreButton.setAttribute('data-current-page', data.currentPage);

                if (data.currentPage >= totalPages) {
                    loadMoreButton.style.display = 'none'; // Hide button when all pages are loaded
                }
            } catch (error) {
                console.error('Error loading more items:', error);
            }
        });
    </script>
</body>
</html>
